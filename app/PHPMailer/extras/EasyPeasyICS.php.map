{"version":3,"names":[],"mappings":"","sources":["PHPMailer/extras/EasyPeasyICS.php"],"sourcesContent":["<?php\n/**\n * EasyPeasyICS Simple ICS/vCal data generator.\n * @author Marcus Bointon <phpmailer@synchromedia.co.uk>\n * @author Manuel Reinhard <manu@sprain.ch>\n *\n * Built with inspiration from\n * http://stackoverflow.com/questions/1463480/how-can-i-use-php-to-dynamically-publish-an-ical-file-to-be-read-by-google-calend/1464355#1464355\n * History:\n * 2010/12/17 - Manuel Reinhard - when it all started\n * 2014 PHPMailer project becomes maintainer\n */\n\n/**\n * Class EasyPeasyICS.\n * Simple ICS data generator\n * @package phpmailer\n * @subpackage easypeasyics\n */\nclass EasyPeasyICS\n{\n    /**\n     * The name of the calendar\n     * @var string\n     */\n    protected $calendarName;\n    /**\n     * The array of events to add to this calendar\n     * @var array\n     */\n    protected $events = array();\n\n    /**\n     * Constructor\n     * @param string $calendarName\n     */\n    public function __construct($calendarName = \"\")\n    {\n        $this->calendarName = $calendarName;\n    }\n\n    /**\n     * Add an event to this calendar.\n     * @param string $start The start date and time as a unix timestamp\n     * @param string $end The end date and time as a unix timestamp\n     * @param string $summary A summary or title for the event\n     * @param string $description A description of the event\n     * @param string $url A URL for the event\n     * @param string $uid A unique identifier for the event - generated automatically if not provided\n     * @return array An array of event details, including any generated UID\n     */\n    public function addEvent($start, $end, $summary = '', $description = '', $url = '', $uid = '')\n    {\n        if (empty($uid)) {\n            $uid = md5(uniqid(mt_rand(), true)) . '@EasyPeasyICS';\n        }\n        $event = array(\n            'start' => gmdate('Ymd', $start) . 'T' . gmdate('His', $start) . 'Z',\n            'end' => gmdate('Ymd', $end) . 'T' . gmdate('His', $end) . 'Z',\n            'summary' => $summary,\n            'description' => $description,\n            'url' => $url,\n            'uid' => $uid\n        );\n        $this->events[] = $event;\n        return $event;\n    }\n\n    /**\n     * @return array Get the array of events.\n     */\n    public function getEvents()\n    {\n        return $this->events;\n    }\n\n    /**\n     * Clear all events.\n     */\n    public function clearEvents()\n    {\n        $this->events = array();\n    }\n\n    /**\n     * Get the name of the calendar.\n     * @return string\n     */\n    public function getName()\n    {\n        return $this->calendarName;\n    }\n\n    /**\n     * Set the name of the calendar.\n     * @param $name\n     */\n    public function setName($name)\n    {\n        $this->calendarName = $name;\n    }\n\n    /**\n     * Render and optionally output a vcal string.\n     * @param bool $output Whether to output the calendar data directly (the default).\n     * @return string The complete rendered vlal\n     */\n    public function render($output = true)\n    {\n        //Add header\n        $ics = 'BEGIN:VCALENDAR\nMETHOD:PUBLISH\nVERSION:2.0\nX-WR-CALNAME:' . $this->calendarName . '\nPRODID:-//hacksw/handcal//NONSGML v1.0//EN';\n\n        //Add events\n        foreach ($this->events as $event) {\n            $ics .= '\nBEGIN:VEVENT\nUID:' . $event['uid'] . '\nDTSTAMP:' . gmdate('Ymd') . 'T' . gmdate('His') . 'Z\nDTSTART:' . $event['start'] . '\nDTEND:' . $event['end'] . '\nSUMMARY:' . str_replace(\"\\n\", \"\\\\n\", $event['summary']) . '\nDESCRIPTION:' . str_replace(\"\\n\", \"\\\\n\", $event['description']) . '\nURL;VALUE=URI:' . $event['url'] . '\nEND:VEVENT';\n        }\n\n        //Add footer\n        $ics .= '\nEND:VCALENDAR';\n\n        if ($output) {\n            //Output\n            $filename = $this->calendarName;\n            //Filename needs quoting if it contains spaces\n            if (strpos($filename, ' ') !== false) {\n                $filename = '\"'.$filename.'\"';\n            }\n            header('Content-type: text/calendar; charset=utf-8');\n            header('Content-Disposition: inline; filename=' . $filename . '.ics');\n            echo $ics;\n        }\n        return $ics;\n    }\n}\n"],"file":"EasyPeasyICS.php"}